# 音声花火ゲーム 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
音声花火ゲーム（Speech Fireworks Game）

### 1.2 目的
音声認識またはテキスト入力によって指定された文字列を花火のパーティクルエフェクトとして表示するインタラクティブなWebアプリケーション

### 1.3 対象ユーザー
- 音声認識技術に興味のあるユーザー
- 視覚的なエフェクトを楽しみたいユーザー
- 日本語での音声入力体験を求めるユーザー

## 2. 機能要件

### 2.1 基本機能

#### 2.1.1 音声認識機能
- **機能**: ブラウザの音声認識APIを使用した日本語音声入力
- **仕様**:
  - 言語設定: 日本語（ja-JP）
  - 連続認識: 無効（単発認識）
  - 中間結果: 無効
  - 最大入力文字数: 50文字
- **制約**: WebkitSpeechRecognition API対応ブラウザでのみ利用可能

#### 2.1.2 テキスト入力機能
- **機能**: キーボードによる直接テキスト入力
- **仕様**:
  - 入力フィールドでの手動入力
  - Enterキーでの即座実行
  - 最大文字数: 50文字

#### 2.1.3 花火エフェクト表示機能
- **機能**: 入力されたテキストを花火パーティクルとして表示
- **仕様**:
  - テキストを粒子化して表示
  - 2段階のアニメーション（保持→拡散）
  - 黄色〜オレンジ系の色合い
  - フェードアウト効果

### 2.2 表示・UI要件

#### 2.2.1 画面レイアウト
- **背景**: 黒色グラデーション（#001122 → #000033）
- **キャンバス**: フルスクリーン表示
- **コントロールパネル**: 画面上部固定、半透明背景

#### 2.2.2 コントロール要素
- **音声認識ボタン**: 録音状態の視覚的フィードバック
- **テキスト入力フィールド**: プレースホルダー付き
- **打ち上げボタン**: テキスト実行
- **ステータス表示**: 現在の状態を表示

#### 2.2.3 レスポンシブ対応
- **モバイル対応**: 768px以下で縦並びレイアウト
- **画面サイズ変更**: 自動リサイズ対応

### 2.3 パフォーマンス要件

#### 2.3.1 アニメーション
- **フレームレート**: 60FPS（requestAnimationFrame使用）
- **粒子数**: 動的調整（テキストサイズに応じて）
- **メモリ管理**: 死んだ粒子の自動削除

#### 2.3.2 レスポンス性
- **音声認識**: リアルタイムフィードバック
- **テキスト処理**: 即座実行
- **エフェクト表示**: スムーズなアニメーション

## 3. 技術要件

### 3.1 開発環境
- **言語**: HTML5, CSS3, JavaScript (ES6+)
- **API**: Web Speech API (webkitSpeechRecognition)
- **グラフィックス**: HTML5 Canvas API
- **依存関係**: なし（外部ライブラリ不使用）

### 3.2 ブラウザ対応
- **推奨**: Chrome, Safari, Edge（WebkitSpeechRecognition対応）
- **音声認識非対応ブラウザ**: テキスト入力のみ利用可能

### 3.3 設定パラメータ
```javascript
CONFIG = {
    DOT_GAP: 3,           // ドットのサンプリング間隔
    HOLD_MS: 1000,        // 文字形状を保持する時間
    SPREAD_SPEED: 2,      // 拡散速度
    FADE_SPEED: 0.02,     // フェード速度
    MAX_LIFE: 1.0,        // 粒子の最大寿命
    FONT_SIZE_BASE: 120,  // ベースフォントサイズ
    FONT_SIZE_MIN: 40,    // 最小フォントサイズ
    MAX_TEXT_WIDTH: 0.8   // 画面幅に対する最大テキスト幅
}
```

## 4. 非機能要件

### 4.1 可用性
- **起動時間**: 即座起動（ファイル読み込みのみ）
- **エラー処理**: 音声認識エラー時の適切なフィードバック
- **フォールバック**: 音声認識非対応時のテキスト入力利用

### 4.2 ユーザビリティ
- **直感的操作**: ワンクリックでの音声認識開始
- **視覚的フィードバック**: 録音状態の明確な表示
- **キーボードショートカット**: Enterキーでの実行

### 4.3 保守性
- **コード構造**: クラスベースの設計
- **設定管理**: 定数による設定の一元管理
- **イベント処理**: 適切なイベントリスナー管理

## 5. 制約事項

### 5.1 技術的制約
- 音声認識はHTTPS環境またはlocalhostでのみ動作
- ブラウザの音声認識APIに依存
- 外部ライブラリの使用禁止

### 5.2 機能制約
- 同時に表示できる花火は1つまで
- 音声認識は連続認識非対応
- カスタム音声モデルの使用不可

### 5.3 パフォーマンス制約
- 大量の粒子生成時のフレームレート低下の可能性
- メモリ使用量は粒子数に比例

## 6. 今後の拡張可能性

### 6.1 機能拡張
- 複数色の花火パターン
- 音声による花火の種類選択
- アニメーション効果の追加
- 音響効果の追加

### 6.2 技術拡張
- WebGLを使用した3Dエフェクト
- Web Audio APIを使用した音響効果
- PWA化によるオフライン対応
- モバイルアプリ化

## 7. テスト要件

### 7.1 機能テスト
- 音声認識の精度テスト
- テキスト入力の動作確認
- 花火エフェクトの表示確認
- レスポンシブデザインの確認

### 7.2 ブラウザテスト
- Chrome, Safari, Edgeでの動作確認
- モバイルブラウザでの動作確認
- 音声認識非対応ブラウザでの動作確認

### 7.3 パフォーマンステスト
- 長時間使用時のメモリリーク確認
- 大量テキスト入力時のパフォーマンス確認
- フレームレートの安定性確認
